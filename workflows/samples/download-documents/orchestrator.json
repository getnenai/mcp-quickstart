{
  "name": "Download Documents",
  "workflow_id": "sample-download-documents",
  "description": "Navigate to patient profile and download all documents",
  "variables": [
    {
      "name": "PATIENT_NAME",
      "value": "",
      "description": "Patient name to search for"
    },
    {
      "name": "LOGIN_EMAIL",
      "value": "",
      "description": "Login email address"
    },
    {
      "name": "LOGIN_PASSWORD",
      "value": "",
      "type": "password",
      "secret_id": "login_password",
      "description": "Login password"
    }
  ],
  "states": [
    {
      "name": "system_ready",
      "comparison_config": {
        "strategy": "bash_command",
        "command": "whoami",
        "expected_output": "computeruse"
      }
    },
    {
      "name": "documents_downloaded",
      "comparison_config": {
        "strategy": "bash_command",
        "command": "ls /artifacts/*.pdf 2>/dev/null | wc -l | xargs -I{} test {} -gt 0 && echo 'downloaded' || echo 'none'",
        "expected_output": "downloaded"
      }
    }
  ],
  "initial_state": {"name": "system_ready"},
  "desired_state": "documents_downloaded",
  "transitions": [
    {
      "name": "download_workflow",
      "from_state": {"name": "system_ready"},
      "to_state": {"name": "documents_downloaded"},
      "fsm_file": "./workflow.json"
    }
  ],
  "max_global_retries": 2,
  "setup": {
    "actions": [
      {
        "type": "clear_directory",
        "target_dir": "/artifacts",
        "description": "Clear previous downloads"
      }
    ]
  }
}
